@model ProductDetailVM

@await Html.PartialAsync("_MobileMenuPartialView")

<section class="breadcrumb-section">
    <h2 class="sr-only">Site Breadcrumb</h2>
    <div class="container">
        <div class="breadcrumb-contents">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a asp-action="Index" asp-controller="Home">Home</a></li>
                    <li class="breadcrumb-item "><a asp-action="Index" asp-controller="Product">Shop</a></li>
                    <li class="breadcrumb-item active">Product</li>
                </ol>
            </nav>
        </div>
    </div>
</section>
<main class="inner-page-sec-padding-bottom">
    <div class="container">
        <div class="row  mb--60">
            <div class="col-lg-5 mb--30">
                <!-- Product Details Slider Big Image-->
                <div class="product-details-slider sb-slick-slider arrow-type-two" data-slick-setting='{
              "slidesToShow": 1,
              "arrows": false,
              "fade": true,
              "draggable": false,
              "swipe": false,
              "asNavFor": ".product-slider-nav"
              }'>
                    @if (Model.Product.Images != null)
                    {
                        @foreach (var image in Model.Product.Images.Where(pi => !pi.IsDeleted).ToList())
                        {
                            <div style="max-width:370px;width:100%; height:370px; object-fit:cover;" class="single-slide">
                                <img style="max-width:370px;width:100%; height:370px; object-fit:cover;" src="~/cilent/image/products/@image.Url" alt="Image">
                            </div>
                        }
                    }
                </div>
                <!-- Product Details Slider Nav -->
                <div class="mt--30 product-slider-nav sb-slick-slider arrow-type-two" data-slick-setting='{
            "infinite":true,
              "autoplay": true,
              "autoplaySpeed": 8000,
              "slidesToShow": 4,
              "arrows": true,
              "prevArrow":{"buttonClass": "slick-prev","iconClass":"fa fa-chevron-left"},
              "nextArrow":{"buttonClass": "slick-next","iconClass":"fa fa-chevron-right"},
              "asNavFor": ".product-details-slider",
              "focusOnSelect": true
              }'>
                    @if (Model.Product.Images != null)
                    {
                        @foreach (var image in Model.Product.Images.Where(pi => !pi.IsDeleted).ToList())
                        {
                            <div style="max-width:120px;width:100%; height:120px; object-fit:cover; padding:0 10px" class="single-slide">
                                <img style="max-width:120px;width:100%; height:120px; object-fit:cover;" src="~/cilent/image/products/@image.Url" alt="Image">
                            </div>
                        }
                    }

                </div>
            </div>
            <div class="col-lg-7">
                <div class="product-details-info pl-lg--30 ">
                    <p class="tag-block">
                        Tags:
                        @if (Model.Product != null && Model.Tags != null)
                        {
                            foreach (var tag in Model.Tags)
                            {
                                <a href="~/cilent/#">#@tag.Name  </a>
                            }

                        }
                    </p>
                    <h3 class="product-title">@Model.Product.Name</h3>
                    <ul class="list-unstyled">
                        <li>Ex Tax: <span class="list-value"> $@Model.Product.ExTax</span></li>
                        <li>Author: <a href="~/cilent/#" class="list-value font-weight-bold"> @Model.Product.Author</a></li>
                        <li>Product Code: <span class="list-value"> @Model.Product.ProductCode</span></li>
                        <li>Reward Points: <span class="list-value"> @Model.Product.RewardPoint</span></li>
                        <li>Availability: <span class="list-value"> @(Model.Product.Count > 0 ? " In Stock" : "Out of Stock")</span></li>
                    </ul>
                    <div class="price-block">

                        @if (Model.Product.DiscountPrice > 0)
                        {
                            <span class="price-new">$@Model.Product.DiscountPrice</span>
                            <del class="price-old">$@Model.Product.Price</del>
                        }
                        else
                        {
                            <span class="price-new">$@Model.Product.Price</span>
                        }

                    </div>
                    <article class="product-details-article">
                        <h4 class="sr-only">Product Summery</h4>
                        <p>
                            @Model.Product.Description
                        </p>
                    </article>
                    <div class="add-to-cart-row">
                        <div class="add-cart-btn">
                            <a href="#" class="btn btn-outlined--primary prod basket" data-id="@Model.Product.Id">
                                <span class="plus-icon">+</span>Add to
                                Cart
                            </a>
                        </div>
                    </div>
                    <div class="compare-wishlist-row">
                        <a href="~/cilent/#" class="add-link wish" data-id="@Model.Product.Id"><i class="fas fa-heart"></i>Add to Wish List</a>
                        <a href="~/cilent/#" class="add-link"><i class="fas fa-random"></i>Add to Compare</a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!--=================================
        RELATED PRODUCTS BOOKS
    ===================================== -->
    <section class="">
        <div class="container">
            <div class="section-title section-title--bordered">
                <h2>RELATED PRODUCTS</h2>
            </div>
            <div class="product-slider sb-slick-slider slider-border-single-row" data-slick-setting='{
                "autoplay": true,
                "autoplaySpeed": 8000,
                "slidesToShow": 4,
                "dots":true
            }' data-slick-responsive='[
                {"breakpoint":1200, "settings": {"slidesToShow": 4} },
                {"breakpoint":992, "settings": {"slidesToShow": 3} },
                {"breakpoint":768, "settings": {"slidesToShow": 2} },
                {"breakpoint":480, "settings": {"slidesToShow": 1} }
            ]'>

                @foreach (var related in Model.relatedProducts)
                {
                    <div class="single-slide">
                        <div class="product-card">
                            <div class="product-header">
                                <a href="~/cilent/#" class="author">
                                    @related.Author
                                </a>
                                <h3><a asp-action="Detail" asp-route-id="@related.Id">@related.Name</a></h3>
                            </div>
                            <div class="product-card--body">
                                <div class="card-image">
                                    <img style="width:270px;height:270px;object-fit:cover" src="~/cilent/image/products/@related.Images.Where(i=>i.IsMain&&!i.IsDeleted).FirstOrDefault()?.Url" alt="">


                                    <div class="hover-contents">
                                        <a asp-action="Detail" asp-route-id="@related.Id" class="hover-image">
                                            <img style="width:270px;height:270px;object-fit:cover" src="~/cilent/image/products/@related.Images.Where(i=>i.IsHover&&!i.IsDeleted).FirstOrDefault()?.Url" alt="">
                                        </a>
                                        <div class="hover-btns">
                                            <a href="~/cilent/cart.html" class="single-btn basketss" data-id="@related.Id" >
                                                <i class="fas fa-shopping-basket"></i>
                                            </a>
                                            <a href="~/cilent/wishlist.html" class="single-btn wishs" data-id="@related.Id">
                                                <i class="fas fa-heart"></i>
                                            </a>
                                            <a href="~/cilent/compare.html" class="single-btn">
                                                <i class="fas fa-random"></i>
                                            </a>
                                            <a href="~/cilent/#" data-toggle="modal" data-target="#quickModal"
                                               class="single-btn">
                                                <i class="fas fa-eye"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                               
                            </div>
                        </div>
                    </div>
                }

            </div>
        </div>
    </section>
    <!-- Modal -->
    <div class="modal fade modal-quick-view" id="quickModal" tabindex="-1" role="dialog"
         aria-labelledby="quickModal" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <button type="button" class="close modal-close-btn ml-auto" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <div class="product-details-modal">
                    <div class="row">
                        <div class="col-lg-5">
                            <!-- Product Details Slider Big Image-->
                            <div class="product-details-slider sb-slick-slider arrow-type-two"
                                 data-slick-setting='{
              "slidesToShow": 1,
              "arrows": false,
              "fade": true,
              "draggable": false,
              "swipe": false,
              "asNavFor": ".product-slider-nav"
              }'>
                                <div class="single-slide">
                                    <img src="~/cilent/image/products/product-details-1.jpg" alt="">
                                </div>
                                <div class="single-slide">
                                    <img src="~/cilent/image/products/product-details-2.jpg" alt="">
                                </div>
                                <div class="single-slide">
                                    <img src="~/cilent/image/products/product-details-3.jpg" alt="">
                                </div>
                                <div class="single-slide">
                                    <img src="~/cilent/image/products/product-details-4.jpg" alt="">
                                </div>
                                <div class="single-slide">
                                    <img src="~/cilent/image/products/product-details-5.jpg" alt="">
                                </div>
                            </div>
                            <!-- Product Details Slider Nav -->
                            <div class="mt--30 product-slider-nav sb-slick-slider arrow-type-two"
                                 data-slick-setting='{
            "infinite":true,
              "autoplay": true,
              "autoplaySpeed": 8000,
              "slidesToShow": 4,
              "arrows": true,
              "prevArrow":{"buttonClass": "slick-prev","iconClass":"fa fa-chevron-left"},
              "nextArrow":{"buttonClass": "slick-next","iconClass":"fa fa-chevron-right"},
              "asNavFor": ".product-details-slider",
              "focusOnSelect": true
              }'>
                                <div class="single-slide">
                                    <img src="~/cilent/image/products/product-details-1.jpg" alt="">
                                </div>
                                <div class="single-slide">
                                    <img src="~/cilent/image/products/product-details-2.jpg" alt="">
                                </div>
                                <div class="single-slide">
                                    <img src="~/cilent/image/products/product-details-3.jpg" alt="">
                                </div>
                                <div class="single-slide">
                                    <img src="~/cilent/image/products/product-details-4.jpg" alt="">
                                </div>
                                <div class="single-slide">
                                    <img src="~/cilent/image/products/product-details-5.jpg" alt="">
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-7 mt--30 mt-lg--30">
                            <div class="product-details-info pl-lg--30 ">
                                <p class="tag-block">Tags: <a href="~/cilent/#">Movado</a>, <a href="~/cilent/#">Omega</a></p>
                                <h3 class="product-title">Beats EP Wired On-Ear Headphone-Black</h3>
                                <ul class="list-unstyled">
                                    <li>Ex Tax: <span class="list-value"> £60.24</span></li>
                                    <li>Brands: <a href="~/cilent/#" class="list-value font-weight-bold"> Canon</a></li>
                                    <li>Product Code: <span class="list-value"> model1</span></li>
                                    <li>Reward Points: <span class="list-value"> 200</span></li>
                                    <li>Availability: <span class="list-value"> In Stock</span></li>
                                </ul>
                                <div class="price-block">
                                    <span class="price-new">£73.79</span>
                                    <del class="price-old">£91.86</del>
                                </div>
                                <div class="rating-widget">
                                    <div class="rating-block">
                                        <span class="fas fa-star star_on"></span>
                                        <span class="fas fa-star star_on"></span>
                                        <span class="fas fa-star star_on"></span>
                                        <span class="fas fa-star star_on"></span>
                                        <span class="fas fa-star "></span>
                                    </div>
                                    <div class="review-widget">
                                        <a href="~/cilent/#">(1 Reviews)</a> <span>|</span>
                                        <a href="~/cilent/#">Write a review</a>
                                    </div>
                                </div>
                                <article class="product-details-article">
                                    <h4 class="sr-only">Product Summery</h4>
                                    <p>
                                        Long printed dress with thin adjustable straps. V-neckline and wiring
                                        under the Dust with ruffles at the bottom
                                        of the
                                        dress.
                                    </p>
                                </article>
                                <div class="add-to-cart-row">
                                    <div class="count-input-block">
                                        <span class="widget-label">Qty</span>
                                        <input type="number" class="form-control text-center" value="1">
                                    </div>
                                    <div class="add-cart-btn">
                                        <a href="~/cilent/#" class="btn btn-outlined--primary">
                                            <span class="plus-icon">+</span>Add to Cart
                                        </a>
                                    </div>
                                </div>
                                <div class="compare-wishlist-row">
                                    <a href="~/cilent/#" class="add-link"><i class="fas fa-heart"></i>Add to Wish List</a>
                                    <a href="~/cilent/#" class="add-link"><i class="fas fa-random"></i>Add to Compare</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="widget-social-share">
                        <span class="widget-label">Share:</span>
                        <div class="modal-social-share">
                            <a href="~/cilent/#" class="single-icon"><i class="fab fa-facebook-f"></i></a>
                            <a href="~/cilent/#" class="single-icon"><i class="fab fa-twitter"></i></a>
                            <a href="~/cilent/#" class="single-icon"><i class="fab fa-youtube"></i></a>
                            <a href="~/cilent/#" class="single-icon"><i class="fab fa-google-plus-g"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>



@section BrandSlider {
    @await Html.PartialAsync("_BrandSliderPartialView")
}



@section Script {

    <script>

        let baskets = document.querySelectorAll('.basketss')
        baskets.forEach(btn => {
            btn.addEventListener('click', e => {
                e.preventDefault()

                const id = btn.dataset.id;
                console.log(id)

                fetch(`/Product/AddBasket/${id}`)
                    .then(res => {
                        if (res.ok) {
                            const cartCountElement = document.querySelector('.text-number');
                            const currentCount = parseInt(cartCountElement.innerText);
                            cartCountElement.innerText = currentCount + 1;

                            toastr.success("Product added to cart");
                        } else {
                            toastr.warning("An error occurred while adding the product to the cart...");
                        }
                    })
                    .catch(err => console.error(err));
            })
        })

        let wishs = document.querySelectorAll('.wishs')
        wishs.forEach(btn => {
            btn.addEventListener('click', e => {
                e.preventDefault()

                const id = btn.dataset.id;
                console.log(id)

                fetch(`/Product/AddWish/${id}`)
                    .catch(err => console.error(err));
            })
        })




        document.querySelector('.basket').addEventListener('click', (e) => {
            e.preventDefault();


            const id = e.target.dataset.id;

            fetch(`/Product/AddBasket/${id}`)
                .then(res => {
                    if (res.ok) {
                        const cartCountElement = document.querySelector('.text-number');
                        const currentCount = parseInt(cartCountElement.innerText);
                        cartCountElement.innerText = currentCount + 1;

                        toastr.success("Product added to cart");
                    } else {
                        toastr.warning("An error occurred while adding the product to the cart...");
                    }
                })
                .catch(err => console.error(err));
        });

        document.querySelector('.wish').addEventListener('click', (e) => {
            e.preventDefault();
            console.log('wish')
            const id = e.target.dataset.id;
            console.log(id)

            fetch(`/Product/AddWish/${id}`)
                .catch(err => console.error(err));
        });


    </script>
}










